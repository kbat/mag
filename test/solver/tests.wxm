/* [wxMaxima batch file version 1] [ DO NOT EDIT BY HAND! ]*/
/* [ Created with wxMaxima version 20.12.1 ] */
/* [wxMaxima: title   start ]
Test 1: single particle, transmission only
   [wxMaxima: title   end   ] */


/* [wxMaxima: comment start ]
Transmission matrices
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
nTn : matrix([1,2], [3,4]);
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Spectrum of neutrons incident on the 1st layer
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef : matrix([1,3]);
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Neutron spectrum after the 1st layer
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef.nTn;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Neutron spectrum after the 2nd layer
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef.nTn.nTn;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Neutron spectrum after the 3rd layer
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef.nTn.nTn.nTn;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: title   start ]
Test 2: two particles, only T
   [wxMaxima: title   end   ] */


/* [wxMaxima: comment start ]
Transmission matrices
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
nTe : matrix([2,3], [4,5]);
eTn : matrix([3,4], [5,6]);
eTe : matrix([4,5], [6,7]);
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Spectra of e and n after the 1st layer
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef.nTn; sdef.nTe;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Spectra of e and n after the 2nd layer
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef2n : sdef.nTn.nTn + sdef.nTe.eTn;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: input   start ] */
sdef2e: sdef.nTe.eTe+sdef.nTn.nTe;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Spectra of e and n after the 3rd layer
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef2n.nTn+sdef2e.eTn;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: input   start ] */
sdef2n.nTe+sdef2e.eTe;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: title   start ]
Test 3: three particle types, only T
   [wxMaxima: title   end   ] */


/* [wxMaxima: comment start ]
sdef and transmission matrices
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef : matrix([1,5,3,7])$
nTn : matrix([1,2,3,4],[5,6,7,8],[9,10,11,12],[13,14,15,16])$
nTe : matrix([2,3,4,5],[6,7,8,9],[10,11,12,13],[14,15,16,17])$
nTp : matrix([3,4,5,6],[7,8,9,10],[11,12,13,14],[15,16,17,18])$
eTn : matrix([4,5,6,7],[8,9,10,11],[12,13,14,15],[16,17,18,19])$
eTe : matrix([5,6,7,8],[9,10,11,12],[13,14,15,16],[17,18,19,20])$
eTp : matrix([6,7,8,9],[10,11,12,13],[14,15,16,17],[18,19,20,21])$
pTn : matrix([7,8,9,10],[11,12,13,14],[15,16,17,18],[19,20,21,22])$
pTe : matrix([8,9,10,11],[12,13,14,15],[16,17,18,19],[20,21,22,23])$
pTp : matrix([9,10,11,12],[13,14,15,16],[17,18,19,20],[21,22,23,24])$
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Spectra after the 1st layer
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef.nTn;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: input   start ] */
sdef.nTe;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: input   start ] */
sdef.nTp;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Spectra after the 2nd layer
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef2n: sdef.nTn.nTn + sdef.nTe.eTn + sdef.nTp.pTn;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: input   start ] */
sdef2e: sdef.nTn.nTe + sdef.nTe.eTe + sdef.nTp.pTe;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: input   start ] */
sdef2p: sdef.nTn.nTp+sdef.nTe.eTp+sdef.nTp.pTp;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Spectra after the 3rd layer
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef2n.nTn + sdef2e.eTn + sdef2p.pTn;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: input   start ] */
sdef2n.nTe + sdef2e.eTe + sdef2p.pTe;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: input   start ] */
sdef2n.nTp + sdef2e.eTp + sdef2p.pTp;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: title   start ]
Test 4: T and R with single particle
   [wxMaxima: title   end   ] */


/* [wxMaxima: input   start ] */
nTn : matrix([1,2], [3,4]);
nRn: matrix([11,12], [13,14]);
sdef: matrix([1, 3]);
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Neutron spect
   [wxMaxima: comment end   ] */


/* [wxMaxima: comment start ]
Neutron spectrum after the 2nd layer is a sum of transmitted and reflected+transmitted parts
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef2: sdef.(nTn.nTn+nTn.nRn.nRn.nTn);
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Neutron spectrum after the 3rd layer
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef3: sdef2.(nTn+nRn.nRn.nTn);
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Neutron spectrum after 4 layers
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef3.(nTn+nRn.nRn.nTn);
/* [wxMaxima: input   end   ] */


/* [wxMaxima: title   start ]
Test 5: T and R with 2 particles
   [wxMaxima: title   end   ] */


/* [wxMaxima: input   start ] */
sdef: matrix([1, 3]);
nTn : matrix([1,2], [3,4]);
nTe : matrix([2,3], [4,5]);
eTn : matrix([3,4], [5,6]);
eTe : matrix([4,5], [6,7]);
nRn : matrix([0.1, 0.2], [0.3, 0.4]);
nRe : matrix([1.1, 1.2], [1.3, 1.4]);
eRn : matrix([2.1, 2.2], [2.3, 2.4]);
eRe : matrix([3.1, 3.2], [3.3, 3.4]);
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Spectra after the 1st layer (only T since no R possible yet)
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef1n : sdef.nTn;
sdef1e : sdef.nTe;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Directly Transmitted spectra after the 2nd layer
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef2n : sdef1n.nTn + sdef1e.eTn;
sdef2e : sdef1n.nTe + sdef1e.eTe;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Reflected back
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdefRn : sdef1n.nRn + sdef1e.eRn;
sdefRe : sdef1n.nRe + sdef1e.eRe;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Transmitted through the previous (1st) layer
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef1Rn : sdefRn.nRn + sdefRe.eRn;
sdef1Re : sdefRn.nRe + sdefRe.eRe;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Transmitted through the 2nd layer (contribution from the reflected part)
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef2Rn: sdef1Rn.nTn + sdef1Re.eTn;
sdef2Re: sdef1Rn.nTe + sdef1Re.eTe;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Both transmitted and reflected contributions
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef2n_tot: sdef2n + sdef2Rn;
sdef2e_tot: sdef2e + sdef2Re;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Spectra after the 3rd layer
Directly Transmitted spectra after the 3rd layer
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef3n: sdef2n_tot.nTn + sdef2e_tot.eTn;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: input   start ] */
sdef3e: sdef2n_tot.nTe + sdef2e_tot.eTe;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Reflected back
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdefRn: sdef2n_tot.nRn + sdef2e_tot.eRn;
sdefRe: sdef2n_tot.nRe + sdef2e_tot.eRe;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Transmitted through the previous (2nd) layer (reflected forward)
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef3Rn: sdefRn.nRn + sdefRe.eRn;
sdef3Re: sdefRn.nRe + sdefRe.eRe;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Transmitted through the 3rd layer (contribution from the transmitted part)
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef3Rn_tot: sdef3Rn.nTn + sdef3Re.eTn;
sdef3Re_tot: sdef3Rn.nTe + sdef3Re.eTe;
/* [wxMaxima: input   end   ] */


/* [wxMaxima: comment start ]
Both transmitted and reflected contributions
   [wxMaxima: comment end   ] */


/* [wxMaxima: input   start ] */
sdef3n+sdef3Rn_tot;
sdef3e+sdef3Re_tot;
/* [wxMaxima: input   end   ] */



/* Old versions of Maxima abort on loading files that end in a comment. */
"Created with wxMaxima 20.12.1"$
